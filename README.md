# 💙InnoView Tech (A407)💙

## Smart View & Im-Frame
- [협업 노션](https://www.notion.so/a8c1a23e51634590a1d57a92306c2d7a)
- [깃랩](https://lab.ssafy.com/s10-final/S10P31A407.git)

##  👨‍👩‍👦‍👦 **Team**

<table>
 <tr>
    <td align="center"><a href="https://github.com/"><img src="README.assets/png/hjw_profile.png" width="80px;" alt=""></td>
    <td align="center"><a href="https://github.com/"><img src="README.assets/png/khj_profile.png" width="80px;" alt=""></td>
    <td align="center"><a href="https://github.com/"><img src="README.assets/png/nhk_profile.png" width="80px;" alt=""></td>
    <td align="center"><a href="https://github.com/"><img src="README.assets/png/lgh_profile.png" width="80px;" alt=""></td>
    <td align="center"><a href="https://github.com/"><img src="README.assets/png/lws_profile.png" width="80px;" alt=""></td>
    <td align="center"><a href="https://github.com/"><img src="README.assets/png/lbe_profile.png" width="80px;" alt=""></td>
    
  </tr>
  <tr>
    <td align="center">팀장</td>
    <td align="center">팀원</td>
    <td align="center">팀원</td>
    <td align="center">팀원</td>
    <td align="center">팀원</td>
    <td align="center">팀원</td>
  </tr>
     <tr>
    <td align="center"><a href="https://github.com/"><sub><b>한진우</b></td>
    <td align="center"><a href="https://github.com/"><sub><b>김호준</b></td>
    <td align="center"><a href="https://github.com/dreamzzing"><sub><b>노현경</b></td>
    <td align="center"><a href="https://github.com/ghlee96"><sub><b>이규형</b></td>
    <td align="center"><a href="https://github.com/"><sub><b>이원석</b></td>
    <td align="center"><a href="https://github.com/"><sub><b>임병은</b></td>
    
  </tr>

</table>



## 🔨 기술스택


<img src="https://img.shields.io/badge/linux-FCC624?style=for-the-badge&logo=linux&logoColor=black">
<img src="https://img.shields.io/badge/ubuntu-E95420?style=for-the-badge&logo=ubuntu&logoColor=white">
<img src="https://img.shields.io/badge/nvidia-76B900?style=for-the-badge&logo=nvidia&logoColor=white">
<img src="https://img.shields.io/badge/arduino-00878F?style=for-the-badge&logo=arduino&logoColor=white">
<img src="https://img.shields.io/badge/zigbee-EB0443?style=for-the-badge&logo=zigbee&logoColor=white">
<img src="https://img.shields.io/badge/python-3776AB?style=for-the-badge&logo=python&logoColor=white">
<img src="https://img.shields.io/badge/c-A8B9CC?style=for-the-badge&logo=c&logoColor=black">
<img src="https://img.shields.io/badge/c++-00599C?style=for-the-badge&logo=cplusplus&logoColor=white">
<img src="https://img.shields.io/badge/go-00ADD8?style=for-the-badge&logo=go&logoColor=white">
<img src="https://img.shields.io/badge/sqlite-003B57?style=for-the-badge&logo=sqlite&logoColor=white">
<img src="https://img.shields.io/badge/firebase-FFCA28?style=for-the-badge&logo=firebase&logoColor=black">
<img src="https://img.shields.io/badge/smartthings-15BFFF?style=for-the-badge&logo=smartthings&logoColor=white">

***

<img src="https://img.shields.io/badge/pytorch-EE4C2C?style=for-the-badge&logo=pytorch&logoColor=white">
<img src="https://img.shields.io/badge/tensorflow-FF6F00?style=for-the-badge&logo=tensorflow&logoColor=white"/>
<img src="https://img.shields.io/badge/jupyter-F37626?style=for-the-badge&logo=jupyter&logoColor=white"/>
<img src="https://img.shields.io/badge/opencv-5C3EE8?style=for-the-badge&logo=opencv&logoColor=white">
<img src="https://img.shields.io/badge/edgeimpulse-3B47C2?style=for-the-badge&logo=edgeimpulse&logoColor=white"/>
<img src="https://img.shields.io/badge/mozilla-000000?style=for-the-badge&logo=mozilla&logoColor=white"/>

***
<img src="https://img.shields.io/badge/androidstudio-3DDC84?style=for-the-badge&logo=androidstudio&logoColor=white">
<img src="https://img.shields.io/badge/react-61DAFB?style=for-the-badge&logo=react&logoColor=black">
<img src="https://img.shields.io/badge/node.js-339933?style=for-the-badge&logo=Node.js&logoColor=white">
<img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black">
<img src="https://img.shields.io/badge/kotlin-7F52FF?style=for-the-badge&logo=kotlin&logoColor=white">
<img src="https://img.shields.io/badge/typescript-3178C6?style=for-the-badge&logo=typescript&logoColor=white">
<img src="https://img.shields.io/badge/redux-764ABC?style=for-the-badge&logo=redux&logoColor=white">
<img src="https://img.shields.io/badge/ruby-CC342D?style=for-the-badge&logo=ruby&logoColor=white">
<img src="https://img.shields.io/badge/gradle-02303A?style=for-the-badge&logo=gradle&logoColor=white">


***

<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/jira-0052CC?style=for-the-badge&logo=jira&logoColor=white"/>
<img src="https://img.shields.io/badge/notion-000000?style=for-the-badge&logo=notion&logoColor=white"/>
<img src="https://img.shields.io/badge/mattermost-0058CC?style=for-the-badge&logo=mattermost&logoColor=white">
<img src="https://img.shields.io/badge/gerrit-EEEEEE?style=for-the-badge&logo=gerrit&logoColor=black"/>

## 📺 하드웨어 구성도
 <img src= "/README.assets/hardware.PNG" align="center" width="80%">

- 젯슨 나노
- 터치 디스플레이
- Arduino
- Motor
- Camera
- Mic
- Tof
- Zigbee 모듈
- LED


## 💫 주제선정배경
 <img src= "/README.assets/goal.PNG" align="center" width="80%" >
 
> 팀이 처음에 목표한 것

- 하드웨어가 있고 모바일과 연동이 가능하며 실생활 편의를 위한 것을 개발하고자 함.
- 사용성이 있고 판매할 수 있는 제품을 만들고자 함.
- Ondevice AI를 구현해보고자 함.
- 기기의 SmartThings 연결을 목표함.


## ❓ 기획배경
- 핵가족화의 가속화로 떨어져 사는 가족이 많음
- 일상을 사진으로 나누는데, 좀 더 특별하고 재미있게 선물처럼 나누고자 함
- 최근 삼성 가전에는 디스플레이가 탑재되는 경우가 많은데, 이 디스플레이를 다른 방향으로 활용해보고자 함
- 가전은 단순히 기능만 제공하는 것이 아니라 인테리어적 요소로 활용되고 있고, 이에 사용자가 원하는 인테리어 분위기를 만드는 제품을 고안함
- 하나의 제품이 하나의 기능만 하는 것이 아니라 여러가지 기능이 탑재되어 있고, 다른 제품을 제어하는 등의 확장성을 가진 제품이 인기가 많음


## ❗ 차별점
- 각 센서별 OnDevice 기능 탑재
- SmartThings 어플리케이션에서 디바이스 확인 가능
- SmartThings 어플리케이션에서 디바이스 제어 및 루틴 추가 가능
- 모션 또는 음성인식으로 앨범 제어 및 타 SmartThings 기기 제어 가능
- 제한된 하드웨어 환경에서 음성, 모션, 사진공유, 트래킹 기능 모두 사용될 수 있도록 사용자 경험에 기반한 병렬처리

## ⏩ 발전 내역
### SmartView
 <p>
    <img src="/README.assets/smartview1.png"  width="20%"style="margin-right: 120px;">
    <img src="/README.assets/smartview2.png"  width="17%">
</p>

- 하드보드지로 외관 제작, 디스플레이와 하드웨어 모두 탑재된 완제품


### ImFrame
 <img src= "/README.assets/im_frame.jpg" align="center" width="50%">

- 다른 디스플레이(TV, 모니터 등)에 호환 가능하도록 소프트웨어 업그레이드
- 디스플레이를 별도로 구매하지 않아도 되어 소비자가 절감

## 🔜 추후 방향성
- TizenOS 앱으로 개발 후 디스플레이 탑재된 가전에서 모두 활용할 수 있도록 설계
- SmartThings를 활용한 지속적 디바이스 소프트웨어 업데이트


## 🔲 디스플레이


### 연동
 <img src= "/README.assets/group_picture_on_device.gif" align="center">
 
>어플리케이션으로 그룹 내 멤버의 액자 사진 변경

- 최초 실행 시 카메라 화면 출력
- 사용자의 어플리케이션의 QR코드를 인식하여 firebase uid 관련 txt파일 생성
- 그룹 공유된 사진이 있을 경우 snapshot으로 감지 및 디스플레이에 출력
- 사진 메타데이터 데이터베이스 저장 및 사진 폴더에 다운로드
- 업로드 된 사진을 메타데이터 및 이미지 파싱 데이터 데이터베이스 저장 및 사진 폴더에 다운로드

### 화면
 <img src= "/README.assets/PyQt-Logo.png" align="center" width="40%">

- pyQt5를 사용하여 화면 전체 사이즈로 이미지 출력
- 터치로 이전 사진, 다음 사진 변경 기능
- 터치로 사진 확대 및 축소 기능

## 🎤 음성
 <p align="center">
    <img src="/README.assets/picovoice_logo.jpg"  width="30%">
    <img src="/README.assets/clova_logo.png"  width="40%"style="margin-right: 30px;">
    <img src="/README.assets/konlpy_logo.png"  width="20%">
</p>

### 트리거
- picovoice를 통한 특정 단어로 한국어 모델 제작 및 탑재하여 온디바이스로 실행 가능
- stt파일 트리거, 다음 사진으로 이동하는 트리거, 모션센서 트리거
- pvrecorder로 특정 단어에만 반응하도록 설계
- stt를 쓰레드로 실행시키고 있을 때 잠시 정지 후 stt 쓰레드가 종료되면 재실행 및 LED로 사용자에게 알림

### STT
 <img src= "/README.assets/keyword.gif" align="center">
 
>"고양이 사진 보여줘"
- 한국어에 적합한 네이버 CSR을 사용
- 사용자의 음성을 듣고 있을 때 LED를 키고, 음성 인식을 종료할 때 LED를 끔
- 5초 동안 사용자의 말을 듣고 2회 연속으로 아무 말도 감지되지 않을 경우 자동 종료
- 메타데이터 및 이미지 라벨링 관련 단어로 DB에서 사진 검색
- DB에 해당하는 사진이 있을 경우 해당 사진을 디스플레이에 출력 후 종료
- 스마트싱스 연동 관련 단어를 인지할 경우 스마트싱스 지그비 통신 실행

### TTS
- 트리거가 인식되었을 때, 사용자에게 인식됨을 알림
- 2회 연속 인식되는 stt가 없을 때 사용자에게 종료를 알림
- 사용자가 stt종료 로직을 실행하면 종료됨을 알림
- 스마트싱스 지그비 통신이 완료되었을 때 실행됨을 사용자에게 알림

## 👏 모션
 <img src= "/README.assets/make_model.gif" align="center">
 
>모션인식 모델 학습 과정
- 100번의 훈련 사이클과 40,000번의 비교 테스트를 통한 결과 99.6% 정확도 확인

### 카메라
 <img src= "/README.assets/tsm-model-logo.png" align="center" width="40%">

#####
- 음성에서 모션인식을 실행시키는 트리거가 불려졌을 때 실행
- 조도 감지하여 인지 어려울 경우 tof센서를 통해 감지
- 3가지 동작관련 모델 직접 제작 후 경량화하여 탑재
- 스마트싱스 실행 관련으로, 스마트싱스 어플리케이션에서 모션별 실행 루틴 설정 가능

### ToF센서
- 음성에서 모션인식을 실행시키는 트리거가 불려졌을 때 실행
- 인식되는 움직임이 확인이 불가할 경우 카메라를 통해 감지
- 3가지 동작관련 모델 직접 제작 후 경량화하여 탑재
- 스마트싱스 실행 관련으로, 스마트싱스 어플리케이션에서 모션별 실행 루틴 설정 가능


## 🌟 SmartThings


###
 <img src= "/README.assets/smartthings_light.gif" align="center">
 
> 스마트싱스, 불꺼줘

<p align="center">
    <img src="/README.assets/SmartThings_logo.png" width="60%" style="margin-right: 120px;">
    <img src="/README.assets/zigbee-logo.jpg" width="10%">
</p>

- 스마트 싱스 플랫폼에 기기 연결
  - Zigbee 프로토콜 사용 인터넷 연결 없이 스마트싱스 허브와 통신
  - 스마트싱스 앱으로 기기 관리 가능
- 루틴 기능을 통해 스마트싱스에 연결 가능한 다른 기기 제어
  - 스마트싱스 루틴 설정 예시
 <img src= "/README.assets/smartthings_routine.png" align="center" width="40%">
  
  ###
  - 기기를 통한 루틴 실행 Demo
 <p align="center">
    <img src="/README.assets/smartthings_light_on.gif"  width="40%">
    <img src="/README.assets/smartthings_light_change.gif"  width="40%">
</p>

## 📱 어플리케이션
### 회원가입
<img src="/README.assets/signup.gif"  width="60%">

- 모바일으로 접속 시 보이는 회원가입 화면
- Firebase Authentication 이용
- 회원정보 미기입 시 alert 생성
- 아이디 중복 체크, 비밀번호 일치여부 확인
- 핸드폰 번호 기 가입 여부 확인

### 로그인
<img src="/README.assets/login.gif"  width="60%">

 - 모바일 접속 시 보이는 로그인 화면
 - Firebase에 등록된 회원 기준으로 아이디, 비밀번호 일치여부 확인
 - 정보 미기입시 alert 생성
 - 회원 UID를 AsyncStorage를 이용해 저장하여 애플리케이션을 종료해도 정보가 남아있음

### QR로 디바이스와 연결
<img src="/README.assets/qrpage.PNG"  width="60%">

- 디바이스 최초 실행 시 카메라 화면 출력
- 사용자가 어플리케이션에서 로그인 하고 QR코드를 디바이스 카메라에 비추면 연동

### 그룹 생성
<img src="/README.assets/search_by_num.gif"  width="60%">

- 최초 회원가입 시 저장한 핸드폰 번호로 사용자 검색 및 그룹 초대

### 그룹에서 제거
<img src="/README.assets/delete_member.gif"  width="60%">

- 추가한 멤버 중 원치 않는 멤버 제거 기능

### 그룹관리를 위한 그룹명 생성
<img src="/README.assets/make_Group.gif"  width="60%">

- 생성하는 그룹명 지정

### 그룹 사진 공유
<img src="/README.assets/upload_group.gif"  width="60%">

- 기존 그룹 확인 기능
- 그룹별 마지막으로 공유된 사진 확인 기능
- 그룹별 사진 업로드 기능
- 그룹 나가기 기능
- 공유할 사진 수정 기능
- 사진 공유 시 메타데이터 함께 업로드
- 그룹에 속해있는 모든 사용자의 디바이스에 사진 공유

### 디바이스에 전송할 사진 선택
<img src="/README.assets/picture_upload1.gif"  width="60%">

- 최초 접속 시 핸드폰 갤러리 접근 권한 허용/거부 기능
- 여러 사진 동시 선택
- 사진 하나만 선택 시 사진 자르기 등 수정 기능
- 리스트에서 원치 않는 사진 바로 삭제 기능

### 디바이스에 선택한 사진 전송
<img src="/README.assets/picture_upload2.gif"  width="60%">

- 사진 업로드 시 메타데이터 함께 업로드
- 동시에 디바이스 DB에 메타데이터 및 사진 분석 키워드 저장

## 😊 사용자 트래킹

 <img src= "/README.assets/tracking.gif" align="center">
 
> 가장 가까이 있는 사람을 인식

- 정의 : 사용자가 제품을 호출 했을 때, 사용자를 바라볼 수 있도록 화면을 회전하는 기능.

- 세부 내용 (순서)
    1. 사용자 인식 - 객체(사람)을 인식하는 머신 러닝 모델을 활용하여 카메라 센서를 통한 영상 이미지에 대해 객체 인식 및 트래킹 진행.
    
    2. 좌표값 계산 - 인식된 객체(사람)들 중 가장 가까운 사람을 찾기 위해 화면 내 객체 박싱 사이즈가 가장 큰 객체에 대해 이미지 좌표값 계산. 화면 중앙과 떨어진 거리(가로x축) 를 계산.
    
    3. 떨어진 거리를 바탕으로 회전 각도, 듀티 사이클을 계산하여 pwm 설정을 통해 잿슨 나노에 연결된 모터 제어 진행.
  
- 기술 설명
    1. 객체 인식 모델
        1. yolov8n 모델 : 인식률, 실시간 반응성 등을 고려했을 떄 널리 사용되는 yolo 버전 8 모델 중 가장 경량화된 모델을 사용.
            
            → 해당 모델을 잿슨나노에서 CPU에만 올려 사용할 경우 메모리 초과 발생. GPU 가속, 스레드 분리 방안 등을 고려해봤지만 메모리를 더 낮춘어도 타 기능에서도 메모리를 많이 사용하게 될 것을 고려했을 때 더 가벼운 모델로 진행하는 것이 좋다고 판단.
            
        2. YOLOX_nano 모델 : params = 0.91 , FLOPs = 1.08 로 v8, v5 모델보다 가벼운 모델을 적용해봄. 기존 yolo 모델과 동일한 이유로 버림.
        3. mediapipe : 잿슨나노 라이브러리 버전 및 의존성 충돌로 인해 사용 불가.
        4. **ssd mobilenet v2 :**
          <img src= "/README.assets/mobilenetv2_logo.jpg" align="center" width="40%">

            1. SSD 에서 기본 네트워크로 MobileNet을 사용하는 모델. 해당 모델은 잿슨나노의 내장 라이브러리인 inference 로 사용가능 하며 GPU 가속을 통한 처리속도 향상과 잿슨나노 환경에 최적화 되어있음. → 처리속도 빠르고 가벼움.
            
            2. MobileNet 은 모바일 및 임베디드 비전 애플리케이션 용으로 설계된 경량 모델. 라즈베리 파이, 스마트폰, 잿슨 나노 등 제한된 장치에서 적시에 프로그램이 동작하도록 개발됨.
            3. SSD는 Google 에서 정확도를 떨어뜨리지 않으면서 임베디드 장치에서 실시간으로 실행할 수 있는 경량 모델로 개발함.
            
            
    2. 모터 제어
       1. 모터를 제어하기 위해 잿슨나노에 내장된 pwm 제너레이터를 통해 모터를 제어했다. 해당 제너레이터를 통해 모터의 회전 방향, 회전 속도를 제어하는 신호를 모터에 보낼 수 있다.


## 💡 브랜치 전략

Github flow + 담당repo + dev

- master : 무결성 유지, dev 브랜치에서만 PR 가능
- dev : 개발용, 기능 브랜치들 merge용, 버그 해결용
- 기능 : 새로운 기능 개발용 (브랜치명을 명시적으로 작성)

```
master
 └─ dev
     ├── 트래킹
     |     ├── 브랜치 1
     |     └── 브랜치 2
     ├── 디바이스
     |     ├── 브랜치 1
     |     └── 브랜치 2
     └── application
```

<br><br>

## 🤙🏻 commit 컨벤션

```
💡 feat : 새로운 기능 추가
🐞 fix : 버그 수정
📄 docs : 문서 수정
🛠 refact : 코드 리팩토링
💅 style : 코드 의미에 영향을 주지 않는 변경사항
📦 chore : 빌드 부분 혹은 패키지 매니저 수정사항
🗑️ del : 삭제
```